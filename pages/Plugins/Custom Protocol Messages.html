<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Custom Protocol Messages | @skeldjs/hindenburg</title>
	<meta name="description" content="Documentation for @skeldjs/hindenburg">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
	<link rel="stylesheet" href="../../assets/css/pages.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.json" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">@skeldjs/hindenburg</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../../modules.html">Globals</a>
				</li>
				<li>
					<a href="Creating a Plugin.html">Plugins</a>
				</li>
				<li>
					<a href="Custom Protocol Messages.html">Custom Protocol Messages</a>
				</li>
			</ul>
			<h1>Custom Protocol Messages</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p>If you have a mod, it might be of interest to create custom protocol messages to communicate additional information between your client and the server.</p>
				<blockquote>
					<p>See <a href="Receiving Protocol Messages.html">Receiving Protocol Messages</a> for information on actaully receiving your messages from the client. This page is just to declare them.</p>
				</blockquote>
				<a href="#message-types" id="message-types" style="color: inherit; text-decoration: none;">
					<h2>Message Types</h2>
				</a>
				<p>As per how the Among Us protocol is structured, messages can be declared on certain levels and as children of certain parent messages. For example, messages that are identified by the first byte are called <em>option</em> packets, although you most likely won&#39;t be using these as they&#39;re part of <a href="https://github.com/willardf/Hazel-Networking">Hazel</a> itself.</p>
				<p>With that in mind, you can declare messages by extending the relevant class:</p>
				<table>
					<thead>
						<tr>
							<th>Type</th>
							<th>Description</th>
							<th>Identifier</th>
							<th>Parent message</th>
							<th>Base class</th>
						</tr>
					</thead>
					<tbody><tr>
							<td><strong>Root</strong></td>
							<td>Used for reliable/unreliable messages, related to stateless communication between the client and the server.</td>
							<td><code>root</code></td>
							<td><a href="../../classes/ReliablePacket.html">ReliablePacket</a>/<a href="../../classes/UnreliablePacket.html">UnreliablePacket</a></td>
							<td><code>BaseRootMessage</code></td>
						</tr>
						<tr>
							<td><strong>GameData</strong></td>
							<td>Used for messages that are related to the game, and communicate with a little bit of state involved.</td>
							<td><code>gamedata</code></td>
							<td><a href="../../classes/GameDataMessage.html">GameDataMessage</a></td>
							<td><code>BaseGameDataMessage</code></td>
						</tr>
						<tr>
							<td><strong>Rpc</strong></td>
							<td>(Remote Procedure Call) Used for messages in games that communicate directly to objects, and are heavily based on recording state.</td>
							<td><code>rpc</code></td>
							<td><a href="../../classes/RpcMessage.html">RpcMessage</a></td>
							<td><code>BaseRpcMessage</code></td>
						</tr>
				</tbody></table>
				<a href="#message-class" id="message-class" style="color: inherit; text-decoration: none;">
					<h2>Message Class</h2>
				</a>
				<blockquote>
					<p>Check out the <a href="https://github.com/SkeldJS/SkeldJS/tree/master/packages/protocol/lib/packets">SkeldJS source</a> for full, proper examples.</p>
				</blockquote>
				<p>Check the <a href="#message-types">table above</a> to know which base class your message class should extend.</p>
				<a href="#example" id="example" style="color: inherit; text-decoration: none;">
					<h3>Example</h3>
				</a>
				<pre><code class="language-ts"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">SayHelloMessage</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">BaseRootMessage</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">static</span><span style="color: #000000"> </span><span style="color: #001080">messageTag</span><span style="color: #000000"> = </span><span style="color: #098658">60</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #0000FF">const</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #001080">messageTag</span><span style="color: #000000"> = </span><span style="color: #098658">60</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #0000FF">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">message</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">();</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">static</span><span style="color: #000000"> </span><span style="color: #795E26">Deserialize</span><span style="color: #000000">(</span><span style="color: #001080">reader</span><span style="color: #000000">: </span><span style="color: #267F99">HazelReader</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">message</span><span style="color: #000000"> = </span><span style="color: #001080">reader</span><span style="color: #000000">.</span><span style="color: #795E26">string</span><span style="color: #000000">();</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">MyRootMessage</span><span style="color: #000000">(</span><span style="color: #001080">message</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #795E26">Serialize</span><span style="color: #000000">(</span><span style="color: #001080">writer</span><span style="color: #000000">: </span><span style="color: #267F99">HazelWriter</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #001080">writer</span><span style="color: #000000">.</span><span style="color: #795E26">string</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #795E26">clone</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">MyRootMessage</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#message-tag" id="message-tag" style="color: inherit; text-decoration: none;">
					<h3>Message tag</h3>
				</a>
				<p>The <code>messageTag</code> property should be any unused integer, as long as it&#39;s the same as the tag that the client sends. This is just used to identfiy your message and decode it when it&#39;s encountered.</p>
				<blockquote>
					<p>The <code>messageTag</code> should generally be between <code>0-255</code>, especially for official Among Us message types.</p>
				</blockquote>
				<blockquote>
					<p>Note that other mods may have their own message tags, so make sure that other mods that you use don&#39;t conflict with your message tags.</p>
				</blockquote>
				<a href="#registering-custom-messages" id="registering-custom-messages" style="color: inherit; text-decoration: none;">
					<h2>Registering custom messages</h2>
				</a>
				<p>Use the <a href="../../modules.html#RegisterMessage">RegisterMessage</a> decorator to register your custom message to be recognised by Hindenburg:</p>
				<pre><code class="language-ts"><span style="color: #000000">@</span><span style="color: #795E26">RegisterMessage</span><span style="color: #000000">(</span><span style="color: #001080">SayHelloMessage</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">HindenburgPlugin</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;hbplugin-mouse-messager-plugin&quot;</span><span style="color: #000000">)</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MouseMessagerPlugin</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">WorkerPlugin</span><span style="color: #000000"> {</span>

<span style="color: #000000">}</span>
</code></pre>
				<blockquote>
					<p>Note that custom messages can <em>only</em> be instantiated and used on a <a href="Worker and Room Plugins.html">worker plugin</a>.</p>
				</blockquote>
				<blockquote>
					<p>Check out {@link Receiving Protocol Messages} to learn how to handle your custom messages sent by clients.</p>
				</blockquote>
				<a href="#sending-custom-messages" id="sending-custom-messages" style="color: inherit; text-decoration: none;">
					<h2>Sending custom messages</h2>
				</a>
				<p>Sending custom messages in Hindenburg is just as simple as instantiating the class, for example:</p>
				<pre><code class="language-ts"><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">sendPacket</span><span style="color: #000000">(</span>
<span style="color: #000000">    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ReliablePacket</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">getNextNonce</span><span style="color: #000000">(),</span>
<span style="color: #000000">        [</span>
<span style="color: #000000">            </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">SayHelloMessage</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;there&#039;s a mouse! where? there on the stair, right there!&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">        ]</span>
<span style="color: #000000">    )</span>
<span style="color: #000000">);</span>
</code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="label pp-nav pp-group">
						<span>Getting <wbr>Started</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Installation.html">Installation</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Environment Variables.html">Environment <wbr>Variables</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Configuration.html">Configuration</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Installing Plugins.html">Installing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Contributing.html">Contributing</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Comparison with Impostor.html">Comparison with <wbr>Impostor</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Using <wbr>Hindenburg</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Chat Commands.html">Chat <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Logging Config.html">Logging <wbr>Config</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Reactor Support.html">Reactor <wbr>Support</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Server-as-a-Host.html">Server-<wbr>as-<wbr>a-<wbr>Host</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Server-as-a-Host.html">Interactive CLI</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Advanced <wbr>Usage</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Usage/Unknown Innernet Objects.html">Unknown <wbr>Innernet <wbr>Objects</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Usage/Message Ordering.html">Message <wbr>Ordering</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Plugins</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Creating a Plugin.html">Creating a <wbr>Plugin</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Developing Plugins.html">Developing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Compatible Hindenburg API Versions.html">Compatible <wbr>Hindenburg API <wbr>Versions</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Publishing Plugins.html">Publishing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Load Ordering.html">Load <wbr>Ordering</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Worker and Room Plugins.html">Worker and <wbr>Room <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Lifecycle Methods.html">Lifecycle <wbr>Methods</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Event Listeners.html">Event <wbr>Listeners</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Receiving Protocol Messages.html">Receiving <wbr>Protocol <wbr>Messages</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Chat Commands.html">Chat <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Player Perspectives.html">Player <wbr>Perspectives</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Event Targets.html">Event <wbr>Targets</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Reactor Integration.html">Reactor <wbr>Integration</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="End Game Intents.html">End <wbr>Game <wbr>Intents</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Server Broadcast.html">Server <wbr>Broadcast</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="CLI Commands.html">CLI <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Custom Roles.html">Custom <wbr>Roles</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Custom Innernet Objects.html">Custom <wbr>Innernet <wbr>Objects</a>
					</li>
					<li class="current pp-nav pp-page">
						<a href="Custom Protocol Messages.html">Custom <wbr>Protocol <wbr>Messages</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Game Codes.html">Game <wbr>Codes</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Advanced <wbr>Topics</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Topics/Object Ownership Guards.html">Object <wbr>Ownership <wbr>Guards</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Guides</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Guides/New Roles.html">New <wbr>Roles</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Guides/Floating Text.html">Floating <wbr>Text</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>API</span>
					</li>
					<li class=" ">
						<a href="../../modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.json"><' + '/script>');</script>
</body>
</html>