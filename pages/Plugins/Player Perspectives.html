<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Player Perspectives | @skeldjs/hindenburg</title>
	<meta name="description" content="Documentation for @skeldjs/hindenburg">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
	<link rel="stylesheet" href="../../assets/css/pages.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.json" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">@skeldjs/hindenburg</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../../modules.html">Globals</a>
				</li>
				<li>
					<a href="Creating a Plugin.html">Plugins</a>
				</li>
				<li>
					<a href="Player Perspectives.html">Player Perspectives</a>
				</li>
			</ul>
			<h1>Player Perspectives</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<blockquote>
					<p>This is an <em>advanced</em> topic. Adequate understand of Hindenburg &amp; the Among Us protocol is recommended.</p>
				</blockquote>
				<blockquote>
					<p>This is a Server-as-a-Host <em>only</em> topic, and although may work to a degree without it, is highily discouraged. See <a href="../Using Hindenburg/Server-as-a-Host.html">Server-as-a-Host</a>.</p>
				</blockquote>
				<p>Perspectives in Hindenburg allow you to create a virtual &quot;playground&quot; world to isolate players and isolate events. They allow you to run separate, but connected, games that diverge from the main game.</p>
				<p>When perspectives are destroyed, players in the perspectives&#39; game states are reverted back to normal.</p>
				<blockquote>
					<p>Note: perspectives may or may not have an impact on your servers&#39; performance depending on how they&#39;re used. Try to limit frequent creations and destructions of them, and don&#39;t over-use filters.</p>
				</blockquote>
				<a href="#examples" id="examples" style="color: inherit; text-decoration: none;">
					<h2>Examples</h2>
				</a>
				<p>For example, you might want to create the effect of a player being &quot;blind&quot;, where every player on their screen has all of their cosmetics removed:</p>
				<p><img src="https://user-images.githubusercontent.com/60631511/200016485-055cd8f8-a07d-4cf0-8a18-348f421fe5fd.png" alt="image"></p>
				<p>You could write something like the following:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">, [ </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">GameDataUpdates</span><span style="color: #000000"> ]);</span>

<span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> [, </span><span style="color: #0070C1">player</span><span style="color: #000000"> ] </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">players</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (!</span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">continue</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">.</span><span style="color: #795E26">setName</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;?????&quot;</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">.</span><span style="color: #795E26">setColor</span><span style="color: #000000">(</span><span style="color: #001080">Color</span><span style="color: #000000">.</span><span style="color: #001080">Black</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">.</span><span style="color: #795E26">setHat</span><span style="color: #000000">(</span><span style="color: #001080">Hat</span><span style="color: #000000">.</span><span style="color: #001080">NoHat</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">.</span><span style="color: #795E26">setPet</span><span style="color: #000000">(</span><span style="color: #001080">Skin</span><span style="color: #000000">.</span><span style="color: #001080">None</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">.</span><span style="color: #795E26">setSkin</span><span style="color: #000000">(</span><span style="color: #001080">Skin</span><span style="color: #000000">.</span><span style="color: #001080">None</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">sleep</span><span style="color: #000000">(</span><span style="color: #098658">10000</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">destroyPerspective</span><span style="color: #000000">();</span>
</code></pre>
				<a href="#system" id="system" style="color: inherit; text-decoration: none;">
					<h2>System</h2>
				</a>
				<a href="#creating-perspectives" id="creating-perspectives" style="color: inherit; text-decoration: none;">
					<h3>Creating perspectives</h3>
				</a>
				<p>Creating perspectives work in Hindenburg by first creating an identical, but separate in memory, room that copies all of the same objects, information and config from the original.</p>
				<p>From then on, this player is considered to be in their own room on the server, completely separate from the original one - however, it retains a reference to it. This reference is used to pass non-isolated data through the use of &quot;filters&quot; that determine what is isolated and what isn&#39;t.</p>
				<p>This awful diagram shows roughly how this works:
				<img src="https://user-images.githubusercontent.com/60631511/200020038-7ba97b4e-d941-4551-a4ad-954b4e199a28.png" alt="image"></p>
				<p>For example, you might have a filter that prevents movement packets being shared between the two distinct rooms, thereby not allowing player in the perspective to see any movement updates from players in the original room, and no players in the original room to see any movement packets from players in the perspective.</p>
				<p>These filters are also categorised by &quot;incoming&quot; and &quot;outgoing&quot; filters, incoming filters filter messages coming from the room into the perspective, and outgoing filters filter messages coming from the perspective into the room.</p>
				<a href="#destroying-perspectives" id="destroying-perspectives" style="color: inherit; text-decoration: none;">
					<h3>Destroying perspectives</h3>
				</a>
				<p>To destroy a perspective, Hindenburg must revert all of the changes done in the perspective while it was open. Technically, this is less of a &quot;revert&quot; and more of an overwrite using the original room information.</p>
				<a href="#creating-perspectives-1" id="creating-perspectives-1" style="color: inherit; text-decoration: none;">
					<h2>Creating perspectives</h2>
				</a>
				<p>Creating perspectives can range from being as easy as a single line to being lots more depending on what you need.</p>
				<p>For very simple perspectives, such as the one above, you can use the <a href="../../enums/PresetFilter.html">PresetFilter</a> enum to select one or more aspects of the game to isolate:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">, [ </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.* ]);</span>
</code></pre>
				<p>You can also omit the filters from the list if you plan to write your own, or if you want to create a dummy perspective:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">);</span>
</code></pre>
				<p><em><a href="../../classes/Room.html#createPerspective">See the documentation on <code>Room.createPerspective</code></a></em>.</p>
				<a href="#preset-filters" id="preset-filters" style="color: inherit; text-decoration: none;">
					<h3>Preset filters</h3>
				</a>
				<a href="#presetfiltergamedataupdates" id="presetfiltergamedataupdates" style="color: inherit; text-decoration: none;">
					<h4><code>PresetFilter.GameDataUpdates</code></h4>
				</a>
				<p>Isolate all updates related to cosmetics, used in the example above.</p>
				<a href="#presetfilterpositionupdates" id="presetfilterpositionupdates" style="color: inherit; text-decoration: none;">
					<h4><code>PresetFilter.PositionUpdates</code></h4>
				</a>
				<p>Isolate all updates related to movement for players.</p>
				<p>For example, you could make a mode where impostors, upon killing a player, gain the ability to seemingly teleport to a location.</p>
				<a href="#presetfiltersettingsupdates" id="presetfiltersettingsupdates" style="color: inherit; text-decoration: none;">
					<h4><code>PresetFilter.SettingsUpdates</code></h4>
				</a>
				<p>Isolate settings updates, allowing some players to have different settings to other players. Helpful for changing individual players&#39; movement speeds, or the number of emergency meetings they can call.</p>
				<a href="#presetfilterchatmessages" id="presetfilterchatmessages" style="color: inherit; text-decoration: none;">
					<h4><code>PresetFilter.ChatMessages</code></h4>
				</a>
				<p>Isolate chat messages.</p>
				<a href="#presetfilterobjectupdates-advanced" id="presetfilterobjectupdates-advanced" style="color: inherit; text-decoration: none;">
					<h4><code>PresetFilter.ObjectUpdates</code> <em>(advanced)</em></h4>
				</a>
				<p>Isolate updates related to spawning or despawning innernet objects.</p>
				<a href="#unidirectional-filters" id="unidirectional-filters" style="color: inherit; text-decoration: none;">
					<h3>Unidirectional filters</h3>
				</a>
				<p>You can also pass another argument to distinguish between <em>incoming</em> filters and <em>outgoing</em> filters.</p>
				<a href="#example" id="example" style="color: inherit; text-decoration: none;">
					<h4>Example</h4>
				</a>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">, [ ], [ </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">PositionUpdates</span><span style="color: #000000">, </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">ChatMessages</span><span style="color: #000000"> ]);</span>
</code></pre>
				<p><em>Acts as a &quot;shadow ban&quot; for players, so that their movements and chat messages aren&#39;t seen by other players.</em></p>
				<a href="#multiple-players" id="multiple-players" style="color: inherit; text-decoration: none;">
					<h2>Multiple Players</h2>
				</a>
				<p>Perspectives can group together any number of players in their own isolated bubble, just pass an array of players into the first parameter:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">([ </span><span style="color: #001080">player1</span><span style="color: #000000">, </span><span style="color: #001080">player2</span><span style="color: #000000">, </span><span style="color: #001080">player3</span><span style="color: #000000"> ], [ ...</span><span style="color: #001080">filters</span><span style="color: #000000"> ]);</span>
</code></pre>
				<a href="#advanced-filters" id="advanced-filters" style="color: inherit; text-decoration: none;">
					<h3>Advanced filters</h3>
				</a>
				<p>Sometimes, the preset filters won&#39;t do, so you&#39;ll have to fine-tune your filters using SkeldJS&#39; <a href="../../classes/PacketDecoder.html">PacketDecoder</a> API.</p>
				<p>You can use the <a href="../../classes/Perspective.html#incomingFilter">Perspective.incomingFilter</a> and <a href="../../classes/Perspective.html#outgoingFilter">Perspective.outgoingFilter</a> separately.</p>
				<blockquote>
					<p>If you want to use  the same incoming filter as outgoing, simply run <code>perspective.incomingFilter = perspective.outgoingFilter</code>.</p>
				</blockquote>
				<a href="#example-1" id="example-1" style="color: inherit; text-decoration: none;">
					<h4>Example</h4>
				</a>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">, [ ]); </span><span style="color: #008000">// use no preset filters</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">outgoingFilter</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #001080">DataMessage</span><span style="color: #000000">, </span><span style="color: #001080">message</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> { </span><span style="color: #008000">// prevent players in original room see movement from the player in the perspective</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">data</span><span style="color: #000000">.</span><span style="color: #001080">byteLength</span><span style="color: #000000"> !== </span><span style="color: #098658">10</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">netobject</span><span style="color: #000000"> = </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">netobjects</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">netId</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">netobject</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #001080">netobject</span><span style="color: #000000"> </span><span style="color: #0000FF">instanceof</span><span style="color: #000000"> </span><span style="color: #267F99">CustomNetworkTransform</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #001080">netobject</span><span style="color: #000000">.</span><span style="color: #001080">ownerId</span><span style="color: #000000"> === </span><span style="color: #001080">ctx</span><span style="color: #000000">.</span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">clientId</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #795E26">cancel</span><span style="color: #000000">();</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">outgoingFilter</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #001080">SyncSettingsMessage</span><span style="color: #000000">, </span><span style="color: #001080">message</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> { </span><span style="color: #008000">// prevent player speed from affecting the original room</span>
<span style="color: #000000">    </span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #795E26">cancel</span><span style="color: #000000">();</span>
<span style="color: #000000">});</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;player.syncsettings&quot;</span><span style="color: #000000">, </span><span style="color: #001080">ev</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> { </span><span style="color: #008000">// prevent original room from overriding player speed</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">ev</span><span style="color: #000000">.</span><span style="color: #001080">settings</span><span style="color: #000000">.</span><span style="color: #001080">playerSpeed</span><span style="color: #000000"> !== </span><span style="color: #098658">4</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #001080">ev</span><span style="color: #000000">.</span><span style="color: #795E26">setSettings</span><span style="color: #000000">({ </span><span style="color: #001080">playerSpeed:</span><span style="color: #000000"> </span><span style="color: #098658">4</span><span style="color: #000000"> });</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">povPlayer</span><span style="color: #000000"> = </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">resolvePlayer</span><span style="color: #000000">(</span><span style="color: #001080">ctx</span><span style="color: #000000">.</span><span style="color: #001080">player</span><span style="color: #000000">); </span><span style="color: #008000">// get player object in the perspective</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">incomingFilter</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #001080">RpcMessage</span><span style="color: #000000">, </span><span style="color: #001080">message</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">data</span><span style="color: #000000"> </span><span style="color: #0000FF">instanceof</span><span style="color: #000000"> </span><span style="color: #267F99">SnapToMessage</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">netId</span><span style="color: #000000"> === </span><span style="color: #001080">povPlayer</span><span style="color: #000000">!.</span><span style="color: #001080">transform</span><span style="color: #000000">!.</span><span style="color: #001080">netId</span><span style="color: #000000">) { </span><span style="color: #008000">// don&#039;t let player in perspective see that they&#039;ve been moved far away</span>
<span style="color: #000000">        </span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #795E26">cancel</span><span style="color: #000000">();</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>

<span style="color: #001080">ctx</span><span style="color: #000000">.</span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">transform</span><span style="color: #000000">?.</span><span style="color: #795E26">snapTo</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Vector2</span><span style="color: #000000">(</span><span style="color: #098658">20</span><span style="color: #000000">, </span><span style="color: #098658">20</span><span style="color: #000000">), </span><span style="color: #0000FF">true</span><span style="color: #000000">); </span><span style="color: #008000">// move the player far away for the players in the original room</span>

<span style="color: #001080">povPlayer</span><span style="color: #000000">!.</span><span style="color: #001080">control</span><span style="color: #000000">!.</span><span style="color: #795E26">syncSettings</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">GameSettings</span><span style="color: #000000">({ </span><span style="color: #008000">// update the perspective&#039;s player speed</span>
<span style="color: #000000">    ...</span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">settings</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">playerSpeed:</span><span style="color: #000000"> </span><span style="color: #098658">4</span>
<span style="color: #000000">}));</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">sleep</span><span style="color: #000000">(</span><span style="color: #098658">7500</span><span style="color: #000000">);</span>

<span style="color: #001080">ctx</span><span style="color: #000000">.</span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">transform</span><span style="color: #000000">?.</span><span style="color: #795E26">snapTo</span><span style="color: #000000">(</span><span style="color: #001080">povPlayer</span><span style="color: #000000">!.</span><span style="color: #001080">transform</span><span style="color: #000000">!.</span><span style="color: #001080">position</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">); </span><span style="color: #008000">// move the player to their new spot on the original room</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">destroyPerspective</span><span style="color: #000000">(); </span><span style="color: #008000">// destroy the perspective, and &quot;move&quot; the player back to the original room</span>
</code></pre>
				<a href="#destroying-the-perspective" id="destroying-the-perspective" style="color: inherit; text-decoration: none;">
					<h2>Destroying the perspective</h2>
				</a>
				<p>Destroying a perspective is as simple as calling its <a href="../../classes/Perspective.html#destroyPerspective">Perspective.destroyPerspective</a> method:</p>
				<pre><code class="language-ts"><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">destroyPerspective</span><span style="color: #000000">();</span>
</code></pre>
				<p>You can also pass in whether or not to restore state of the original room back to the player in the perspective, although the default is <code>true</code>.</p>
				<blockquote>
					<p>Note, if restoring state is set to <code>false</code>, it could lead to some bugs and plenty of desync if not managed correctly.</p>
				</blockquote>
				<a href="#events" id="events" style="color: inherit; text-decoration: none;">
					<h2>Events</h2>
				</a>
				<p>There are two ways to listen to events in Perspectives.</p>
				<a href="#event-listeners" id="event-listeners" style="color: inherit; text-decoration: none;">
					<h3>Event Listeners</h3>
				</a>
				<p>The first and most straight-forward way is to simply attach listeners using SkeldJS&#39; event listener system, for example:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">);</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;player.setname&quot;</span><span style="color: #000000">, </span><span style="color: #001080">ev</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// someone in the perspective has set their name</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>Always note that perspectives, if synced with the main room, will generally fire the same events, <a href="../Advanced Topics/Object Ownership Guards.html">with some exceptions</a>, so attaching listeners may just be as simple for you as <code>perspective.on(&quot;player.setname&quot;, this.onPlayerSetName)</code> if you have a plugin event listener listening on a room and want to also listen to the same event on a perspective.</p>
				<a href="#event-targets" id="event-targets" style="color: inherit; text-decoration: none;">
					<h3>Event Targets</h3>
				</a>
				<p>A nicer and more formatted way to attach listeners is using the exported <code>EventTarget</code> class, and using the <code>@EventListener</code> decorator:</p>
				<pre><code class="language-ts"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MyPerspectiveEventTarget</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">EventTarget</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">EventListener</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;player.setname&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #795E26">onPlayerSetName</span><span style="color: #000000">(</span><span style="color: #001080">ev</span><span style="color: #000000">: </span><span style="color: #267F99">PlayerSetNameEvent</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Perspective</span><span style="color: #000000">&gt;) {</span>

<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>which you can then use to attach a listener:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">player</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">eventTarget</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #001080">MyPerspectiveEventTarget</span><span style="color: #000000">;</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">registerEventTarget</span><span style="color: #000000">(</span><span style="color: #001080">eventTarget</span><span style="color: #000000">);</span>
</code></pre>
				<blockquote>
					<p>See <a href="Event Targets.html">Event Targets</a> for more information.</p>
				</blockquote>
				<blockquote>
					<p>This topic may or may not require knowledge of <a href="../Advanced Topics/Object Ownership Guards.html">Object Ownership Guards</a>, a reading of that is recommended for advanced usages of perspectives.</p>
				</blockquote>
				<a href="#api" id="api" style="color: inherit; text-decoration: none;">
					<h2>API</h2>
				</a>
				<a href="#get-player-in-perspective-from-original-room" id="get-player-in-perspective-from-original-room" style="color: inherit; text-decoration: none;">
					<h3>Get player in perspective from original room</h3>
				</a>
				<pre><code class="language-ts"><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">resolvePlayer</span><span style="color: #000000">(</span><span style="color: #001080">originalPlayer</span><span style="color: #000000">);</span>
</code></pre>
				<p><em>See <a href="../../classes/Perspective.html#resolvePlayer">Perspective.resolvePlayer</a></em></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="label pp-nav pp-group">
						<span>Getting <wbr>Started</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Installation.html">Installation</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Environment Variables.html">Environment <wbr>Variables</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Configuration.html">Configuration</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Installing Plugins.html">Installing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Contributing.html">Contributing</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Getting Started/Comparison with Impostor.html">Comparison with <wbr>Impostor</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Using <wbr>Hindenburg</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Chat Commands.html">Chat <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Logging Config.html">Logging <wbr>Config</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Reactor Support.html">Reactor <wbr>Support</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Server-as-a-Host.html">Server-<wbr>as-<wbr>a-<wbr>Host</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Server-as-a-Host.html">Interactive CLI</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Advanced <wbr>Usage</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Usage/Unknown Innernet Objects.html">Unknown <wbr>Innernet <wbr>Objects</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Usage/Message Ordering.html">Message <wbr>Ordering</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Plugins</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Creating a Plugin.html">Creating a <wbr>Plugin</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Developing Plugins.html">Developing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Compatible Hindenburg API Versions.html">Compatible <wbr>Hindenburg API <wbr>Versions</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Publishing Plugins.html">Publishing <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Load Ordering.html">Load <wbr>Ordering</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Worker and Room Plugins.html">Worker and <wbr>Room <wbr>Plugins</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Lifecycle Methods.html">Lifecycle <wbr>Methods</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Event Listeners.html">Event <wbr>Listeners</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Receiving Protocol Messages.html">Receiving <wbr>Protocol <wbr>Messages</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Chat Commands.html">Chat <wbr>Commands</a>
					</li>
					<li class="current pp-nav pp-page">
						<a href="Player Perspectives.html">Player <wbr>Perspectives</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Event Targets.html">Event <wbr>Targets</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Reactor Integration.html">Reactor <wbr>Integration</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="End Game Intents.html">End <wbr>Game <wbr>Intents</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Server Broadcast.html">Server <wbr>Broadcast</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="CLI Commands.html">CLI <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Custom Roles.html">Custom <wbr>Roles</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Custom Innernet Objects.html">Custom <wbr>Innernet <wbr>Objects</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Custom Protocol Messages.html">Custom <wbr>Protocol <wbr>Messages</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Game Codes.html">Game <wbr>Codes</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Advanced <wbr>Topics</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Advanced Topics/Object Ownership Guards.html">Object <wbr>Ownership <wbr>Guards</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>API</span>
					</li>
					<li class=" ">
						<a href="../../modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.json"><' + '/script>');</script>
</body>
</html>